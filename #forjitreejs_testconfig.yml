folderDatasource:
  object: FolderDatasource
  path: testdata
  dropOnConnect: true

  sampleCircles:
    object: Sample
    circles:
      first_circle:
        object: Circle
        x: 0
        y: 0
      second_circle:
        object: Circle
        x: 0
        y: 0

server:
  object: Server
  port: 8089
  datasource: "@/folderDatasource"
  schema:
    object: Schema

    "GET|WatchCircles":
      object: ActionWatch
      websocket: true
      query:
        circles: null

    "GET|MoveCircle/:circleId":
      object: ActionSet
      mergeInput: false
      query:
        circles:
          ":Params.circleId":
            x: :random({number:1,500})
            y: :random({number:1,500})

    "GET|res/:filename":
      object: ActionResourceGet
      directory: ""

    "GET|index.html":
      object: Page
      html: |
        <!DOCTYPE html>
        <html lang="en">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>Circles</title>
          <script src="/res/forjitree.js"></script>
        </head>
        <body>
        <script>
          class Circle {
            constructor(node) {
              this.node = node
              console.log('Circle initialized')
            }

            Created() {
              console.log('Circle created')
            }

            CreatedChildren() {
              console.log('Circle children created')
            }

            Updated(key, value) {
              console.log('Circle updated')
            }

            Destroyed() {
              console.log('Circle destroyed')
            }
          }

          let Config = new DatasourceClient(null)
          Config.Tree.AddType(Circle)
          Config.websocket = true
          Config.url = "wss://training.place/WatchCircles"
          Config.Created()
        </script>
        </body>
        </html>
